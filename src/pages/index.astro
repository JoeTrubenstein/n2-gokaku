---
import { getCollection } from "astro:content";
import { getLatestPosts } from "../lib/ghost";

import Layout from "@layouts/Layout.astro";
import Hero from "@components/Hero.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import LinkButton from "@components/LinkButton.astro";
import Hr from "@components/Hr.astro";

import Card from "../components/Card";

import getSortedPosts from "@utils/getSortedPosts";

const posts = await getCollection("blog");

const sortedPosts = getSortedPosts(posts);
const recentPosts = sortedPosts.filter(({ data }) => !data.featured);
---

<Layout>
  <Header />
  <main id="main-content">
    <Hero />

    <Hr />

<section id="quick-start" class="py-12">
  <div class="mx-auto max-w-4xl">
    <h2 class="mb-4 text-3xl font-bold">Quick Start</h2>
    <div class="space-y-6 text-lg text-skin-base">
      <div>
        <strong class="text-xl">語彙 (Vocabulary):</strong><br />
        Build your business-level word bank with essential N2 vocabulary.  <br />
        <a href="/vocabulary/" class="text-skin-accent hover:underline">Explore Vocabulary →</a>
      </div>

      <div>
        <strong class="text-xl">文法 (Grammar):</strong><br />
        Conquer the must-know N2 grammar structures for confident communication.  <br />
        <a href="/grammar/" class="text-skin-accent hover:underline">Explore Grammar →</a>
      </div>

      <div>
        <strong class="text-xl">読解 (Reading):</strong><br />
        Practice with authentic N2 passages to boost your comprehension speed.  <br />
        <a href="/reading/" class="text-skin-accent hover:underline">Explore Reading →</a>
      </div>

      <div>
        <strong class="text-xl">聴解 (Listening):</strong><br />
        Train your ears on authentic N2 audio for real-world understanding.  <br />
        <a href="/listening/" class="text-skin-accent hover:underline">Explore Listening →</a>
      </div>

      <div>
        <strong class="text-xl">製品 (Products):</strong><br />
        Premium N2 study tools and N2-inspired merch to level-up your learning.  <br />
        <a href="/products/" class="text-skin-accent hover:underline">Explore Products →</a>
      </div>
    </div>
  </div>
</section>


    <Hr />

    <!--  -->

    <!-- <section id="products" class="bg-skin-background-alt py-12">
      <div class="mx-auto max-w-7xl">
        <h2 class="text-3xl font-bold">Featured Products</h2>

        <div
          class="xl:gap-x-8 mt-6 grid grid-cols-1 gap-x-6 gap-y-10 sm:grid-cols-3"
        >
          <div class="flex flex-col rounded bg-white">

          <div class="mb-4 h-52 w-full rounded bg-skin-accent"></div>
            <h3 class="mb-2 text-xl font-semibold">Notion Templates</h3>
            <p class="mb-4 flex-grow text-gray-700">
              Everything you need to master N2 reading comprehension, including
              target passages, vocab lists, and answer keys.
            </p>
            <a
              href="/listening/"
              class="mt-auto font-medium text-skin-accent hover:underline"
            >
              Get Notion Templates →
            </a>
          </div>

          <div class="flex flex-col rounded bg-white">
            <div class="mb-4 h-52 w-full rounded bg-skin-accent"></div>
            <h3 class="mb-2 text-xl font-semibold">Books</h3>
            <p class="mb-4 flex-grow text-gray-700">
              Drill the most challenging N2 kanji with stroke order guides,
              mnemonic hints, and quiz sheets.
            </p>
            <a
              href="/listening/"
              class="mt-auto font-medium text-skin-accent hover:underline"
            >
              Get N2 Books →
            </a>
          </div>

          <div class="flex flex-col rounded bg-white">

            <div class="mb-4 h-52 w-full rounded bg-skin-accent"></div>
            <h3 class="mb-2 text-xl font-semibold">Merch and Swag</h3>
            <p class="mb-4 flex-grow text-gray-700">
              Quick-reference guide to the top 50 N2 grammar points, with
              example sentences and practice exercises.
            </p>
            <a
              href="/listening/"
              class="mt-auto font-medium text-skin-accent hover:underline"
            >
              Get N2 Merch and Swag →
            </a>
          </div>
        </div>
      </div>
    </section> -->

    {
      recentPosts.length > 0 && (
        <>
          <section id="recent-posts" class="py-12">
            <div class="mx-auto max-w-7xl">
              <h2 class="text-3xl font-bold">Recent Blog Posts</h2>
              <div>
                {recentPosts.map(
                  ({ data, slug }, index) =>
                    index < 2 && (
                      <Card href={`/blog/${slug}/`} frontmatter={data} />
                    )
                )}
              </div>
              <div class="all-posts-btn-wrapper mt-8">
                <LinkButton href="/blog/">
                  all posts
                  <svg xmlns="http://www.w3.org/2000/svg">
                    <path d="m11.293 17.293 1.414 1.414L19.414 12l-6.707-6.707-1.414 1.414L15.586 11H6v2h9.586z" />
                  </svg>
                </LinkButton>
              </div>
            </div>
          </section>
          <Hr />
        </>
      )
    }

    <!-- Newsletter Signup -->
    <section id="newsletter" class="my-8">
      <div class="mx-auto max-w-4xl rounded-xl">
        <h3 class="mb-4 text-center text-2xl font-semibold">
          N2 Gokaku Newsletter
        </h3>
        <p class="text-center mb-6 flex-grow text-lg">Your weekly bento of N2 Japanese. <br/>Simple, satisfying, and perfectly portioned for a quick study break.</p>
        <div
          style="min-height: 58px;max-width: 440px;margin: 0 auto;width: 100%"
        >
          <script
            src="https://cdn.jsdelivr.net/ghost/signup-form@~0.2/umd/signup-form.min.js"
            data-button-color="#3B82F6"
            data-button-text-color="ffffff"
            data-site="https://cms.n2gokaku.com/"
            data-locale="en"
            async></script>
        </div>
      </div>
    </section>
  </main>

  <Hr />
  <Footer />
</Layout>

<style>
  /* ===== Hero Section ===== */
  #hero {
    @apply pb-6 pt-8;
  }
  #hero h1 {
    @apply my-4 inline-block text-3xl font-bold sm:my-8 sm:text-5xl;
  }
  #hero .rss-link {
    @apply mb-6;
  }
  #hero .rss-icon {
    @apply mb-2 h-6 w-6 scale-110 fill-skin-accent sm:mb-3 sm:scale-125;
  }
  #hero p {
    @apply my-2;
  }
  .social-wrapper {
    @apply mt-4 flex flex-col sm:flex-row sm:items-center;
  }
  .social-links {
    @apply mb-1 mr-2 whitespace-nowrap sm:mb-0;
  }

  /* ===== Featured & Recent Posts Sections ===== */
  #featured,
  #recent-posts {
    @apply pb-6 pt-12;
  }
  #featured h2,
  #recent-posts h2 {
    @apply text-2xl font-semibold tracking-wide;
  }
  .all-posts-btn-wrapper {
    @apply my-8 text-center;
  }

  #user-mail {
    color: #282728;
  }
</style>
